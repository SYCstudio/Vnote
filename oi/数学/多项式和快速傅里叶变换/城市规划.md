# 城市规划
[BZOJ3456 Luogu4841]

刚刚解决完电力网络的问题, 阿狸又被领导的任务给难住了.  
刚才说过, 阿狸的国家有n个城市, 现在国家需要在某些城市对之间建立一些贸易路线, 使得整个国家的任意两个城市都直接或间接的连通.  
为了省钱, 每两个城市之间最多只能有一条直接的贸易路径. 对于两个建立路线的方案, 如果存在一个城市对, 在两个方案中是否建立路线不一样, 那么这两个方案就是不同的, 否则就是相同的. 现在你需要求出一共有多少不同的方案.  
好了, 这就是困扰阿狸的问题. 换句话说, 你需要求出n个点的简单(无重边无自环)无向连通图数目.  
由于这个数字可能非常大, 你只需要输出方案数mod 1004535809(479 * 2 ^ 21 + 1)即可.

设 f(i) 表示 i 个点任意连的方案， g(i) 表示 i 个点连成连通图的方案。枚举与 1 在同一个连通块的点的数量，强制让另一部分不连通，可以得到

$$g(i)=f(i)-\sum _ {j=1} ^ {i-1}\binom{i-1}{j-1}g(j)f(i-j)$$

要减一的原因是已经确定 1 在里面了，所以强制在这个里面。展开组合数得到

$$
\begin{align}
g(i)&=f(i)-\sum _ {j=1} ^ {i-1} \frac{(i-1)!}{(i-j)!(j-1)!}g(j)f(i-j)\\
\frac{g(i)}{(i-1)!}&=\frac{f(i)}{(i-1)!}-\sum_{j=1}^{i-1}\frac{g(j)}{(j-1)!}\frac{f(i-j)}{(i-j)!}
\end{align}
$$

设 $A(x),B(x),C(x)$ 分别为 $\frac{g(i)}{(i-1)!},\frac{f(i)}{(i-1)!},\frac{f(i)}{i!}$ 的生成函数，则有 $A(x)=B(x)+A(x)C(x)$